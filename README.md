
# Реферальная система

Простая реферальная система с авторизацией по номеру телефона и инвайт-кодами.

## Описание

Этот проект представляет собой веб-приложение, реализующее реферальную систему. Пользователи могут регистрироваться по номеру телефона, получая уникальный инвайт-код. Они также могут активировать инвайт-коды других пользователей и видеть список пользователей, которые активировали их код.

Фронтенд построен с использованием Next.js, бэкенд - Django REST Framework.

## Функционал

- Авторизация по номеру телефона (имитация SMS-кода)
- Генерация уникального 6-значного инвайт-кода при первой авторизации
- Активация чужих инвайт-кодов (ограничение: один код на пользователя, если код активирован, то активация не работает)
- Просмотр списка пользователей, активировавших ваш инвайт-код
- Просмотр списка доступных инвайт-кодов

## Технологии

### Бэкенд
- Python
- Django
- Django REST Framework (DRF)

### Фронтенд
- Next.js
- React
- Tailwind CSS (предположительно, судя по className)

## Установка и запуск

### Бэкенд (Django)

1.  Клонируйте репозиторий
2.  Создайте виртуальное окружение: `python -m venv venv`
3.  Активируйте виртуальное окружение:
    *   Windows: `venv\Scripts\activate`
    *   macOS/Linux: `source venv/bin/activate`
4.  Установите зависимости: `pip install -r requirements.txt`
5.  Перейдите в директорию `backend`
6.  Примените миграции: `python manage.py migrate`
7.  Создайте суперпользователя (опционально): `python manage.py createsuperuser`
8.  Запустите сервер разработки: `python manage.py runserver`

### Фронтенд (Next.js)

1.  Откройте новую вкладку/терминал
2.  Перейдите в директорию `frontend`
3.  Установите зависимости: `npm install` или `yarn install`
4.  Запустите сервер разработки: `npm run dev` или `yarn dev`

## API

### Базовый URL

```
http://127.0.0.1:8000/api/v1/
```
(или адрес вашего сервера при развертывании)

### Эндпоинты

#### 1. Запрос кода авторизации

**POST** `/mobile_login/`

Отправляет 4-значный код авторизации на номер телефона (имитация отправки SMS).

**Тело запроса:**
```json
{
  "phone_number": "+79991234567"
}
```

**Ответы:**
- `200 OK` - Код успешно отправлен
```json
{
  "message": "Код авторизации отправлен",
  "phone_number": "+79991234567"
}
```
- `400 Bad Request` - Ошибка в данных запроса

---

#### 2. Проверка кода авторизации

**POST** `/verify_code/`

Проверяет введенный код авторизации и создает пользователя при необходимости.

**Тело запроса:**
```json
{
  "phone_number": "+79991234567",
  "code": "1234"
}
```

**Ответы:**
- `200 OK` - Авторизация успешна
```json
{
  "message": "Авторизация успешна",
  "phone_number": "+79991234567",
  "is_new_user": false
}
```
- `400 Bad Request` - Неверный код или истек срок действия

---

#### 3. Получение профиля пользователя

**GET** `/user_profile/<phone_number>/`

Получает информацию о пользователе по номеру телефона.

**Параметры URL:**
- `phone_number` - Номер телефона пользователя

**Ответы:**
- `200 OK` - Профиль успешно получен
```json
{
  "success": true,
  "user": {
    "id": 1,
    "phone_number": "+79991234567",
    "username": "user123",
    "first_name": "Иван",
    "invite_code": "aBc123"
  },
  "invite_codes": [
    {
      "invite_code": "xYz789",
      "is_revoked": false,
      "used_at": "2023-01-01T12:00:00Z",
      "user_phone_number": "+79997654321"
    }
  ]
}
```
- `404 Not Found` - Пользователь не найден

---

#### 4. Активация инвайт-кода

**POST** `/activate_invite/`

Активирует инвайт-код для пользователя.

**Тело запроса:**
```json
{
  "user_id": 1,
  "invite_code": "aBc123"
}
```

**Ответы:**
- `200 OK` - Инвайт-код успешно активирован
```json
{
  "success": true,
  "message": "Инвайт код активирован!"
}
```
- `400 Bad Request` - Неверные данные или код уже активирован

---

## Развертывание

### PythonAnywhere

Этот проект можно развернуть на [PythonAnywhere](https://www.pythonanywhere.com/).

1.  Зарегистрируйтесь на PythonAnywhere.
2.  Создайте новый веб-проект Django.
3.  Загрузите файлы бэкенда в директорию, указанную PythonAnywhere.
4.  Настройте WSGI-файл согласно документации PythonAnywhere для Django.
5.  Установите зависимости в консоли PythonAnywhere: `pip install -r requirements.txt`
6.  Выполните миграции: `python manage.py migrate`
7.  Соберите статические файлы (если необходимо): `python manage.py collectstatic`
8.  Перезагрузите веб-приложение в панели управления PythonAnywhere.

*Примечание: Для развертывания фронтенда (Next.js) на PythonAnywhere может потребоваться отдельный сервер или использование статического хостинга, так как PythonAnywhere в первую очередь ориентирован на Python-приложения. Рассмотрите варианты развертывания Next.js на Vercel, Netlify или аналогичных платформах и настройте CORS на бэкенде.*

## Статусы ответов

- `200 OK` - Запрос успешно выполнен
- `204 No Content` - Запрос успешен, но содержимое отсутствует (редко используется)
- `400 Bad Request` - Ошибка в данных запроса
- `404 Not Found` - Ресурс не найден
- `500 Internal Server Error` - Внутренняя ошибка сервера

## Форматы данных

Все запросы и ответы используют формат `application/json`.
````

Этот `README.md` включает описание проекта, технологии, инструкции по установке, описание API и краткие указания по развертыванию на PythonAnywhere. Вы можете адаптировать пути, имена и детали под вашу конкретную структуру проекта.